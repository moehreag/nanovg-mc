plugins {
    id 'fabric-loom'
}

repositories {
    maven {
        name = "legacy-fabric"
        url = "https://repo.legacyfabric.net/repository/legacyfabric/"
    }
    mavenLocal()
    mavenCentral()
}

/*base {
    archivesName = "nanovg-mc-lwjgl2"
}*/

import org.gradle.internal.os.OperatingSystem

project.ext.lwjglVersion = "3.3.2"

switch (OperatingSystem.current()) {
    case OperatingSystem.LINUX:
        project.ext.lwjglNatives = "natives-linux"
        break
    case OperatingSystem.WINDOWS:
        project.ext.lwjglNatives = "natives-windows"
        break
}

loom {
    setIntermediaryUrl('https://repo.legacyfabric.net/repository/legacyfabric/net/legacyfabric/intermediary/1.8.9/intermediary-1.8.9-v2.jar');
}

dependencies {
    minecraft "com.mojang:minecraft:1.8.9"
    mappings "net.legacyfabric:yarn:1.8.9+build.458"
    modImplementation("net.fabricmc:fabric-loader:${project.loader_version}")

    implementation include(project(path: ":common", configuration: "shadow"))
    modRuntimeOnly "com.github.moehreag:legacy-lwjgl3:895d621496"
    platform("org.lwjgl:lwjgl-bom:$lwjglVersion")

    runtimeOnly "org.lwjgl:lwjgl:$lwjglVersion:$lwjglNatives"
    runtimeOnly "org.lwjgl:lwjgl-assimp:$lwjglVersion:$lwjglNatives"
    runtimeOnly "org.lwjgl:lwjgl-glfw:$lwjglVersion:$lwjglNatives"
    runtimeOnly "org.lwjgl:lwjgl-openal:$lwjglVersion:$lwjglNatives"
    runtimeOnly "org.lwjgl:lwjgl-opengl:$lwjglVersion:$lwjglNatives"
    runtimeOnly "org.lwjgl:lwjgl-stb:$lwjglVersion:$lwjglNatives"
}

configurations.configureEach {
    // Removes LWJGL2 dependencies
    exclude group: "org.lwjgl.lwjgl"
}

compileJava.dependsOn(project(":common").jar)
remapSourcesJar.dependsOn(project(":common").jar)
